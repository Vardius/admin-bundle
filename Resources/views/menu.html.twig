{% import _self as macros %}

<div class="collapse navbar-collapse navbar-ex1-collapse">
    {{ macros.draw(items, null) }}
</div>

{% macro draw(children, name) %}
    {% import _self as macros %}
    {% if children|length > 0 %}
        <ul {% if name is not null %}id="menu-item-{{ name }}" class="collapse"{% else %}class="nav navbar-nav side-nav"{% endif %}>
            {% for child in children %}
                <li {% if app.request.get('_route') == child.path %}class="active"{% endif %}>
                    {% if child.children is empty %}
                    <a href="{% if child.path is not null %}{{ path(child.path) }}{% else %}javascript:void(0);{% endif %}">
                        {{ child.name }}
                        {% if child.icon is not empty %}
                            <i class="fa fa-fw {{ child.icon }}"></i>
                        {% endif %}
                    </a>
                    {% else %}
                        <a href="javascript:void(0);" data-toggle="collapse" data-target="#menu-item-{{ child.name }}">
                            {{ child.name }}
                            {% if child.icon is not empty %}
                                <i class="fa fa-fw {{ child.icon }}"></i>
                            {% endif %}
                        </a>
                        {{ macros.draw(child.children, child.name) }}
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% endif %}
{% endmacro %}
